## Rails について

#### Model

DB に入っているデータの定義を行います。Rails のモデルファイルにはモデルに関するコールバックや、クラス/インスタンスメソッドなどが定義します。ここでは API は関係なく、モデルそのものがどういう振る舞いをするか？のみに関心があります。

#### Controller

Rails では View のテンプレートを返す役割も担いますが、今回のような API モードではパラメーターで受け取った値をもとに DB のデータの取得を担当し、それに対応するデータを JSON 形式で出力します。

#### View

通常の Rails アプリケーションでは画面にデータを表示する部分を担当しています。erb や haml などの形式で書かれることが多いです。

#### Migration

DB のカラムやそのカラムの型(string や interger など)を定義します。Migration ファイルは指示書のようなもので、コマンドを実行することで、ファイル内で定義された通りに DB が作られます。

## フロントエンドの開発について

#### JSX

React では JSX という記法で element(div や button など)を記述していきます。JSX は一見 HTML そのもののように見えますが、JSX は一度 JavaScript に内部的に変換されます。その後、JavaScript が createElement つまり、element を生成するという仕組みです。

#### CORS

CORS は Cross Origin Resource Sharing の略称です。異なるオリジン(URL と言い換えると分かりやすいかもしれません)のリソースに対してアクセスできるようにな受け付ける側の設定のことを指します。

## React のコンポーネント設計の種類分け

再利用性を高めるために、コンポーネント設計が分けることが一般的です。

containers/\*.jsx
components/\*.jsx (必要に応じて Buttons などディレクトリを分ける)

#### 『Container Component』

データを扱うコンポーネントです。
Container Component はデータを持ち、親コンポーネントとして複数の子コンポーネントにデータを渡す役割を持ちます。

#### 『Presentational Component』

受け取ったデータを表示させるだけのコンポーネントです。
(ボタンやモーダルなど)

#### API を呼ぶ関数

React のコンポーネントはあくまでレイアウトやデータを保持することを担当させ、
API を呼び出す部分は関数化して、他のファイルに分けて関心を分離させるほうが好ましいです。

apis/\*.js

#### reducer

React の組み込み API である React Hooks でシンプルにデータを保持できるようにします。
React Hooks の機能である useReducer はカプセル化の手段として最適です。
reducer もコンポーネント内に定義せずに分けてしまう方が良いです。

reducers/\*.js

## REST とは

シンプルな Web システムの設計思想を指します。
「REST の 4 原則」というものがあり、これを満たすものを「RESTful なシステム」と呼びます。

#### REST の 4 原則

① 統一インターフェース
あらかじめ定義されている方法でやり取りする方式です。

- GET・POST・PUT・DELETE 等の HTTP メソッドでやりとりする
- データは JSON 形式でやり取りする
  など

② アドレス可能性
アドレス可能性は、全ての情報が一意な URI（識別子）を持っていて、提供する情報を URI で表現できること

③ 接続性
接続性は、やりとりされる情報にはハイパーリンクを含めることができる、というものです。
１つのリンクから別の情報にリンク(接続)することができて、RESTful なシステム同士なら円滑に情報連携を行うことができます。

④ ステートレス性
ステートとは「状態」を指します。状態がレスで「状態がない」ことを意味します。
つまり、REST ではやりとりが１回ごとに完結します。

## トランザクションとは

１つ以上の処理の中で１つでも失敗したら、処理をロールバック(やり直し)させたい場合にトランザクションを使います。
銀行口座間の取引をイメージするとわかりやすいです。
別の口座にお金を送金する場合、送金した後の入金が仮に失敗した場合、送金の処理をなかったことにする必要があります。
(トランザクションの処理内のどこかで失敗が発生した時点でその処理を失敗にすることでデータ間の整合性が保たれます)

今回の実装では、仮注文データを更新する処理〜オーダーの保存処理に使用しています。
オーダーが完了出来なかった場合に、仮注文データーが変更されてしまうと整合性が保たれなくなるためです。

#### トランザクション時の注意点

トランザクション内では例外が発生した場合にロールバックをするという特徴があります。
破壊的メソッドである attributes!や save!を使ってはじめて失敗時に例外をキャッチしてロールバックを行う必要があります。

## 単体テスト

一つ一つのユニット(API やモデル)が仕様通り動くことを担保するのが単体テストです。
「あるメソッドが期待通りの動きをするか」などをテストします。

## 結合テスト(E2E テスト)

結合テストは複数のユニットを組み合わせた特定の文脈に対して行われるものです。
例)

- PostButton があり、それを押すと HogeController の Post アクションが呼ばれる
- Post アクションの結果 Hoge レコードが生成される
- 画面に"登録が完了しました"と表示される

## TDD とは

テスト駆動開発を指します。(Test Driven Development)

① 目標・目当てを決める
② "失敗する"テストを書く
③ 失敗させる
④ コードを書く
⑤ "成功する"テストにする
この手順によって「動作するコード」を書きます。

⑥ テストが成功する状態を保ちつつリファクタリングを行う

# データベースについて

#### 要件とは

「アプリケーションを作ることで、実現したいこと」です。

例)ネット通販サイトの要件
ユーザーが持っているポイントの有効期限が切れそうであれば
ポイントに加えてあと少しお金を払えば買えるオススメ商品をサイトに表示してあげる

#### 仕様とは

「要件を実現するために、プログラムをどのように動作させるかの規定」です。
"どのように?”という部分に対してフォーカスします。

例)ネット通販サイトの仕様
ポイントの有効期限をどのように計算するか？
ユーザーにオススメする商品をどのように選択するか？

#### RDB(リレーショナルデータベース)とは

テーブル・カラム・レコードの組み合わせでデータを表現するデータベースを指します。

- テーブル（表、Table）
- カラム（列、フィールド、項目、Column）
- レコード（行、Record）

#### 主キー（Primary Key）とは

テーブルのレコード１件を特定することが出来るカラムを指します。

- 主キーの特性
  - テーブルのレコードを特定することができる
  - null が許容されない
  - レコードに主キーの値をセットした後、値を変更することはできない

#### 正規化とは

1 つのテーブルから 2 つ以上のテーブルに分割することで、データが重複しない状態にすること

#### 第一正規形とは

一つのレコードを追加する度にカラムが増えてしまう状態をなくした形です。

#### 第二正規形とは

複数の主キーの組み合わせでレコードを特定するテーブル内で、一部の主キーだけでもレコードを特定出来る状態(部分関数従属)をなくした形です。

#### 第三正規形とは

主キー以外のカラムによってレコードを特定出来る状態(推移関数従属)をなくした形です。
